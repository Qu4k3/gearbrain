<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Práctica PRO2. Energía e Industria: Fichero Fuente xarxa.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Práctica PRO2. Energía e Industria
   &#160;<span id="projectnumber">v2.0 08-12-2014</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generado por Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Buscar');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Página&#160;principal</span></a></li>
      <li><a href="annotated.html"><span>Clases</span></a></li>
      <li class="current"><a href="files.html"><span>Archivos</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Buscar" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>Lista&#160;de&#160;archivos</span></a></li>
      <li><a href="globals.html"><span>Miembros&#160;de&#160;los&#160;ficheros</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>Todo</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Clases</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Archivos</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Funciones</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Páginas</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">xarxa.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="xarxa_8cpp.html">Ir a la documentación de este archivo.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="xarxa_8hpp.html">xarxa.hpp</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;utils.PRO2&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="classxarxa.html#a2c819a998d53defdc6975b9bce2f40f6">    8</a></span>&#160;<a class="code" href="classxarxa.html#a2c819a998d53defdc6975b9bce2f40f6">xarxa::xarxa</a>(<span class="keywordtype">int</span> N, <span class="keywordtype">int</span> C){</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  <a class="code" href="classxarxa.html#ace0903f6b78d2d9d2962e1277ca9364f">paisos</a> = vector&lt;pais&gt;(N);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <a class="code" href="classxarxa.html#aecffcee8c1b62ef2fdb68534c7c11d40">consumidores</a> = C;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;}</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno"><a class="line" href="classxarxa.html#ad037e286c73b9c0e5f62fdd146a0d2c1">   13</a></span>&#160;<a class="code" href="classxarxa.html#ad037e286c73b9c0e5f62fdd146a0d2c1">xarxa::~xarxa</a>(){}</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="classxarxa.html#af6b26132c8c7436da16caab83d628bdb">   15</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classxarxa.html#af6b26132c8c7436da16caab83d628bdb">xarxa::consultar_stock</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; <span class="comment">//Llama a la función pais::escribir_sectores() que escribe los sectores del pais con identificador = id. </span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; <a class="code" href="classxarxa.html#ace0903f6b78d2d9d2962e1277ca9364f">paisos</a>[<span class="keywordtype">id</span>-1] .escribir_sectores();</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;}</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="classxarxa.html#af20c540992ea11953dbf2d614d753659">   20</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classxarxa.html#af20c540992ea11953dbf2d614d753659">xarxa::consultar_energias</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; <span class="comment">//Escribe las energias de todos los paises de la red.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; cout &lt;&lt; <a class="code" href="classxarxa.html#ace0903f6b78d2d9d2962e1277ca9364f">paisos</a>[0].consultar_energia();</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i&lt;<a class="code" href="classxarxa.html#ace0903f6b78d2d9d2962e1277ca9364f">paisos</a>.size(); ++i) cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classxarxa.html#ace0903f6b78d2d9d2962e1277ca9364f">paisos</a>[i].consultar_energia();</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; cout &lt;&lt; endl &lt;&lt; endl;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;}</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="classxarxa.html#a85091edfb3a5508ba32f27f4b8ab2336">   27</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classxarxa.html#a85091edfb3a5508ba32f27f4b8ab2336">xarxa::modificar_stock</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">int</span> s, <span class="keywordtype">int</span> valor){</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <a class="code" href="classxarxa.html#ace0903f6b78d2d9d2962e1277ca9364f">paisos</a>[<span class="keywordtype">id</span>-1].actualizar_sector(s,valor);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;}</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="classxarxa.html#aef15d6730052991629e0cd8b0060fd8e">   32</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classxarxa.html#aef15d6730052991629e0cd8b0060fd8e">xarxa::modificar_energia</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">int</span> n){</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="comment">//Llama a la funcion pais::actualizar_energia que le suma a su energia, n ( Negativa o positiva).</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="classxarxa.html#ace0903f6b78d2d9d2962e1277ca9364f">paisos</a>[<span class="keywordtype">id</span>-1].actualizar_energia(n);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;}</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="classxarxa.html#a5478c8984b5b3ebfe0aa81be3af0423c">   37</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classxarxa.html#a5478c8984b5b3ebfe0aa81be3af0423c">xarxa::ciclo_produccion</a>(<a class="code" href="classindustria.html">industria</a> &amp;ind){</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">//LLama a la función industria::ronda_produccion que se encarga de hacer un ciclo de producción.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  ind.<a class="code" href="classindustria.html#a72972484fa0f3c0ea4b986325cf8ae8e">ronda_produccion</a>(<a class="code" href="classxarxa.html#ace0903f6b78d2d9d2962e1277ca9364f">paisos</a>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classxarxa.html#aae116556d8225a7f4191cf2508bdfc04">   42</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classxarxa.html#aae116556d8225a7f4191cf2508bdfc04">xarxa::distribu_ETS</a>(<span class="keywordtype">int</span> ETS1, <span class="keywordtype">int</span> ID , <span class="keywordtype">bool</span> consumidor, <span class="keywordtype">int</span> &amp;ETese1, <span class="keywordtype">int</span> &amp;ETesedre, <span class="keywordtype">int</span> &amp;ETese2, vector&lt;pais&gt; &amp;paisos){</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">int</span> nfills = paisos[ID-1].consultar_fills(); <span class="comment">//Numero de hijos del pais con identificador = ID</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">int</span> ETese;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">int</span> energia = paisos[ID-1].consultar_energia();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">if</span>(not consumidor and nfills &gt;0){  <span class="comment">//Distribución de la energía segun las normas del enunciado. Se tiene en cuenta el numero de hijos , si es consumidor o productor y la paridad de ETS1</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">if</span>(nfills == 1){</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      ETese1 = ETS1+energia;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      ETesedre = ETese2 = 0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      ETese = energia;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  ETese2 = (energia +ETS1)/ 2;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  ETese1 = (energia+ETS1) - ETese2;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  ETesedre = energia/2;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  ETese = (energia)-ETesedre;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span>(nfills==1){</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      ETese1 = ETese = ETS1;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      ETese2 = ETesedre = 0;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  ETese2 = ETesedre = ETS1/2;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  ETese1 = ETese = ETS1-ETese2;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">return</span> ETese;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;} </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="classxarxa.html#a430ca24e344bced66b55f331a837a53a">   73</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classxarxa.html#a430ca24e344bced66b55f331a837a53a">xarxa::ronda_pedidos</a>(Arbre&lt;int&gt; &amp;copia, <span class="keywordtype">int</span> &amp;ETS, vector&lt;pais&gt; &amp;paisos, <span class="keyword">const</span> vector&lt;int&gt; &amp;pedidos){</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">//Esta operación nos realizará todo el trabajo de una ronda de pedidos, donde los paises consumidores harán sus pedidos de energía</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">//y los países productores intentarán satisfacerlos en la medida de lo posible. Para ello y para facilitar la comprensión </span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">//utilizaremos la función auxiliar distribu_ETS que nos calculará todos los datos que necesitaremos por lo que respecta a la transmisión de </span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">//energía entre un país y su/s sucesore/s. Distinguiremos entre diferentes casos dentro de un arbol no vacío, ya que según la normativa un consumidor</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">//no hará lo mismo que un productor. Como la variable ETS se reutiliza tanto como dato de bajada (Energía que puede utilizar un sucesor) como cuando se sube</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">//de la recursividad (Energía que se ha usado por sus sucesores y que aún no se &quot;ha saldado&quot;) distinguiremos la ETS que le llega de su predecesor o en el caso de la raíz del arbol</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">//de la función que llama a la función de immersión como ETSINI y la ETS que utilizaremos para saber que energía queda por saldar como ETS igual. </span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">// </span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  Arbre&lt;int&gt; fill1;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  Arbre&lt;int&gt; fill2;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">int</span> ETesedre, ETese2, ETese, ETese1;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">int</span> nfills;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">if</span>(copia.es_buit()){  <span class="comment">//Caso base: Cuando el arbol es vacío, la energía usada ETS = 0 ya que un arbol vacío (sin país) no puede utilizar energía de un pedido, nos aseguramos que en el caso recursivo no haya arboles vacíos</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    ETS = 0;            <span class="comment">//al consultar la raíz.</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">else</span>{                <span class="comment">//Caso recursivo: Distinguiremos 3 casos: dos de consumidor y uno de productor.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">int</span> t = copia.arrel();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">bool</span> consumidor = (t &lt;= pedidos.size()); <span class="comment">//pedidos tiene tamaño = número de consumidores, lo aprovechamos.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    ETese = <a class="code" href="classxarxa.html#aae116556d8225a7f4191cf2508bdfc04">distribu_ETS</a>(ETS,t,consumidor,ETese1,ETesedre,ETese2,paisos); <span class="comment">//ETese=Energía propia que le puede pasar al hijo derecho, ETesedre = Energía propia que le puede pasar al hijo izquierdo, ETese1 energía total que le puede pasar al hijo izquierdo, ETese2 energía total que le puede pasar al hijo derecho. Si solo tiene un hijo ETesedre y ETese2 son cero.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    copia.fills(fill1,fill2); <span class="comment">//fill1 = Hijo izquierdo , fill2 = Hijo derecho</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classxarxa.html#a430ca24e344bced66b55f331a837a53a">ronda_pedidos</a>(fill1,ETese1, paisos, pedidos);<span class="comment">//HI1: ETese1INI= ETese1, ETese1INI es la ETS que li arriba al succesor del seu  predecesor, fará la ronda de pedidos dels succesors, ETese1 = Energia que se ha utilizado por los sucesores de la banda derecha. Si ese hijo es vacío, ETese1 será 0 como marca el caso base.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classxarxa.html#a430ca24e344bced66b55f331a837a53a">ronda_pedidos</a>(fill2,ETese2, paisos, pedidos);<span class="comment">//HI2: ETese2INI= ETese2, ETese2INI es la ETS que li arriba al succesor del seu  predecesor, fará la ronda de pedidos dels succesors, ETese1 = Energia que se ha utilizado por los sucesores de la banda izquierda. Si ese hijo es vacío, ETese2 será 0 como marca el caso base.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">if</span>(t&lt;=pedidos.size() and ETese1 == 0 and ETese2 == 0){ <span class="comment">//Consumidor hoja o que sus sucesores también consumidores no han utilizado energía (no han hecho pedidos).</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span>((ETS - pedidos[t-1]) &lt; 0){ </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      paisos[t-1].actualizar_energia(ETS); <span class="comment">//Se ha utilizado toda la ETSINI disponible. ETS = ETSINI no hace falta modificarlo</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      paisos[t-1].actualizar_energia(pedidos[t-1]);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      ETS = pedidos[t-1]; <span class="comment">//Se ha utilizado parte de la ETSINI disponible. ETS = el pedido del consumidor.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(t&lt;=pedidos.size()){ <span class="comment">//Consumidores restantes</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">int</span> ETSusable = ETS - ETese1 - ETese2; <span class="comment">//Energia que se podrá utilizar es la ETSINI menos la que hayan utilizado sus consumidores sucesores (ETese1 y ETese2)</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span>((ETSusable - pedidos[t-1])&lt;0) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      paisos[t-1].actualizar_energia(ETSusable); <span class="comment">// Se ha utilizado toda la energía disponible.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      ETS = ETSusable + ETese1 + ETese2; <span class="comment">//Se acumula la deuda por saldar.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      paisos[t-1].actualizar_energia(pedidos[t-1]); <span class="comment">//Aún queda energía disponible que podrán utilizar los consumidores predecesores si hay.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      ETS = pedidos[t-1] + ETese1 + ETese2; <span class="comment">//Energia usada será la energía usada por sus sucesores mas la que ha usado este.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">else</span>{ <span class="comment">//Productor</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="keywordflow">if</span>((ETese - ETese1) &lt; 0){ <span class="comment">//La energia propia que le pasa al sucesor izquierdo no es suficiente para saldar la deuda, aún habrá deuda pendiente para sus predecesores productores.</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      paisos[t-1].actualizar_energia(-ETese);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      ETese1 = (ETese-ETese1) * -1;  <span class="comment">//deuda del sucesor derecho por saldar.</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      paisos[t-1].actualizar_energia(-ETese1);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      ETese1 = 0;  <span class="comment">//Se salda toda la deuda con la energía propia que le pasa al sucesor izquierdo.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   <span class="keywordflow">if</span>((ETesedre - ETese2) &lt; 0){ <span class="comment">//La energia propia que le pasa al sucesor derecho no es suficiente para saldar la deuda, aún habrá deuda pendiente para sus predecesores productores.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      paisos[t-1].actualizar_energia(-ETesedre);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      ETese2 = (ETesedre - ETese2)* -1; <span class="comment">//deuda del sucesor izquierdo por saldar</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      paisos[t-1].actualizar_energia(-ETese2);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      ETese2 = 0; <span class="comment">//Se salda toda la deuda con la energía propia que le pasa al sucesor derecho.</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  ETS = ETese1 + ETese2;  <span class="comment">// ETS = a la suma de las deudas por saldar de los sucesores izquierdo y derecho.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}   </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    </div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="classxarxa.html#ab37fc66cb9572dca4c1793cafc832503">  141</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classxarxa.html#ab37fc66cb9572dca4c1793cafc832503">xarxa::realizar_pedidos</a>(){</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">//Esta es la operación que llamaremos desde el programa principal la cual llama a otra función de immersión llamada ronda_pedidos.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  Arbre&lt;int&gt; copia(<a class="code" href="classxarxa.html#a60e649a749b5e6629ef3086d34a68aba">xarxaID</a>); <span class="comment">//Copia del arbol original para que no se nos machaque al llamar a ronda_pedidos.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordtype">int</span> ETS = 0;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  vector&lt;int&gt; pedidos(<a class="code" href="classxarxa.html#aecffcee8c1b62ef2fdb68534c7c11d40">consumidores</a>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i&lt; pedidos.size(); ++i) pedidos[i]=readint(); <span class="comment">//Leemos los pedidos de los consumidores</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="classxarxa.html#a430ca24e344bced66b55f331a837a53a">ronda_pedidos</a>(copia,ETS,<a class="code" href="classxarxa.html#ace0903f6b78d2d9d2962e1277ca9364f">paisos</a>,pedidos); <span class="comment">//Realizamos la ronda de pedidos.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classxarxa.html#a7f92a89682d33831e9440876573439de">  150</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classxarxa.html#a7f92a89682d33831e9440876573439de">xarxa::llegir_arbre_xarxa</a>(Arbre&lt;int&gt;&amp; xarxaID,<span class="keywordtype">int</span> &amp;marca, vector&lt;pais&gt; &amp;paisos){</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">//Simplemente lee la red de paises de estructura arborea , teniendo en cuenta que si el </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">//identificador es cero se trata de un pais &quot;marca&quot; y no es necesario continuar leyendo. Actualiza </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">//la info de los paises con el número de hijos de cada uno conforme se va leyendo.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    Arbre&lt;int&gt; a1;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    Arbre&lt;int&gt; a2;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">int</span> t;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    cin &gt;&gt; t;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">int</span> fills=2;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span> (t!= marca) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <a class="code" href="classxarxa.html#a7f92a89682d33831e9440876573439de">llegir_arbre_xarxa</a>(a1, marca, paisos); <span class="comment">//HI1: marca = 0; a1 red de sucesores izquierdos.</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <a class="code" href="classxarxa.html#a7f92a89682d33831e9440876573439de">llegir_arbre_xarxa</a>(a2, marca, paisos); <span class="comment">//HI2: marca = 0; a2 red de sucesores derechos.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">if</span>(a1.es_buit()) --fills;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordflow">if</span>(a2.es_buit()) --fills;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      xarxaID.plantar(t,a1,a2); </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">if</span>(t!=0) paisos[t-1].afegir_fills(fills); <span class="comment">//Añadimos la información del número de hijos del pais con identificador t.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="classxarxa.html#aef0e84d787621f0879a9423232d0b434">  169</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classxarxa.html#aef0e84d787621f0879a9423232d0b434">xarxa::leer_red</a>(<span class="keywordtype">int</span> M){</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">//Lee la red y la info de los paises del canal de entrada estandard.</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordtype">int</span> marca = 0;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="classxarxa.html#a7f92a89682d33831e9440876573439de">llegir_arbre_xarxa</a>(<a class="code" href="classxarxa.html#a60e649a749b5e6629ef3086d34a68aba">xarxaID</a>,marca,<a class="code" href="classxarxa.html#ace0903f6b78d2d9d2962e1277ca9364f">paisos</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classxarxa.html#ace0903f6b78d2d9d2962e1277ca9364f">paisos</a>.size(); ++i) <a class="code" href="classxarxa.html#ace0903f6b78d2d9d2962e1277ca9364f">paisos</a>[i].leer_pais(M);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div>
<div class="ttc" id="classindustria_html"><div class="ttname"><a href="classindustria.html">industria</a></div><div class="ttdoc">Representa la información comuna de todos los sectores y las prioridades entre ellos. </div><div class="ttdef"><b>Definition:</b> <a href="industria_8hpp_source.html#l00021">industria.hpp:21</a></div></div>
<div class="ttc" id="classxarxa_html_a430ca24e344bced66b55f331a837a53a"><div class="ttname"><a href="classxarxa.html#a430ca24e344bced66b55f331a837a53a">xarxa::ronda_pedidos</a></div><div class="ttdeci">static void ronda_pedidos(Arbre&lt; int &gt; &amp;copia, int &amp;ETS, vector&lt; pais &gt; &amp;paisos, const vector&lt; int &gt; &amp;pedidos)</div><div class="ttdoc">Ronda de pedidos de todos los paises consumidores de la red. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8cpp_source.html#l00073">xarxa.cpp:73</a></div></div>
<div class="ttc" id="classxarxa_html_a60e649a749b5e6629ef3086d34a68aba"><div class="ttname"><a href="classxarxa.html#a60e649a749b5e6629ef3086d34a68aba">xarxa::xarxaID</a></div><div class="ttdeci">Arbre&lt; int &gt; xarxaID</div><div class="ttdoc">Red de países. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8hpp_source.html#l00030">xarxa.hpp:30</a></div></div>
<div class="ttc" id="classindustria_html_a72972484fa0f3c0ea4b986325cf8ae8e"><div class="ttname"><a href="classindustria.html#a72972484fa0f3c0ea4b986325cf8ae8e">industria::ronda_produccion</a></div><div class="ttdeci">void ronda_produccion(vector&lt; pais &gt; &amp;paises)</div><div class="ttdoc">Modificadora de industria. </div><div class="ttdef"><b>Definition:</b> <a href="industria_8cpp_source.html#l00067">industria.cpp:67</a></div></div>
<div class="ttc" id="classxarxa_html_aae116556d8225a7f4191cf2508bdfc04"><div class="ttname"><a href="classxarxa.html#aae116556d8225a7f4191cf2508bdfc04">xarxa::distribu_ETS</a></div><div class="ttdeci">static int distribu_ETS(int ETS1, int ID, bool consumidor, int &amp;ETese1, int &amp;ETesedre, int &amp;ETese2, vector&lt; pais &gt; &amp;paisos)</div><div class="ttdoc">Distribución del ETS de un país en función de la normativa establecida. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8cpp_source.html#l00042">xarxa.cpp:42</a></div></div>
<div class="ttc" id="classxarxa_html_af6b26132c8c7436da16caab83d628bdb"><div class="ttname"><a href="classxarxa.html#af6b26132c8c7436da16caab83d628bdb">xarxa::consultar_stock</a></div><div class="ttdeci">void consultar_stock(int id) const </div><div class="ttdoc">Operación de escritura. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8cpp_source.html#l00015">xarxa.cpp:15</a></div></div>
<div class="ttc" id="classxarxa_html_a2c819a998d53defdc6975b9bce2f40f6"><div class="ttname"><a href="classxarxa.html#a2c819a998d53defdc6975b9bce2f40f6">xarxa::xarxa</a></div><div class="ttdeci">xarxa(int N, int C)</div><div class="ttdoc">Creadora por defecto. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8cpp_source.html#l00008">xarxa.cpp:8</a></div></div>
<div class="ttc" id="classxarxa_html_ace0903f6b78d2d9d2962e1277ca9364f"><div class="ttname"><a href="classxarxa.html#ace0903f6b78d2d9d2962e1277ca9364f">xarxa::paisos</a></div><div class="ttdeci">vector&lt; pais &gt; paisos</div><div class="ttdoc">Lista de los paises. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8hpp_source.html#l00032">xarxa.hpp:32</a></div></div>
<div class="ttc" id="classxarxa_html_ab37fc66cb9572dca4c1793cafc832503"><div class="ttname"><a href="classxarxa.html#ab37fc66cb9572dca4c1793cafc832503">xarxa::realizar_pedidos</a></div><div class="ttdeci">void realizar_pedidos()</div><div class="ttdoc">Modificadora de las energías. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8cpp_source.html#l00141">xarxa.cpp:141</a></div></div>
<div class="ttc" id="classxarxa_html_a7f92a89682d33831e9440876573439de"><div class="ttname"><a href="classxarxa.html#a7f92a89682d33831e9440876573439de">xarxa::llegir_arbre_xarxa</a></div><div class="ttdeci">static void llegir_arbre_xarxa(Arbre&lt; int &gt; &amp;xarxaID, int &amp;marca, vector&lt; pais &gt; &amp;paisos)</div><div class="ttdoc">Operación de lectura de la red en forma arbórea. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8cpp_source.html#l00150">xarxa.cpp:150</a></div></div>
<div class="ttc" id="xarxa_8hpp_html"><div class="ttname"><a href="xarxa_8hpp.html">xarxa.hpp</a></div><div class="ttdoc">Especificación de la clase xarxa. </div></div>
<div class="ttc" id="classxarxa_html_aef15d6730052991629e0cd8b0060fd8e"><div class="ttname"><a href="classxarxa.html#aef15d6730052991629e0cd8b0060fd8e">xarxa::modificar_energia</a></div><div class="ttdeci">void modificar_energia(int id, int n)</div><div class="ttdoc">Modificadora de la energia de un pais con identificador id. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8cpp_source.html#l00032">xarxa.cpp:32</a></div></div>
<div class="ttc" id="classxarxa_html_a85091edfb3a5508ba32f27f4b8ab2336"><div class="ttname"><a href="classxarxa.html#a85091edfb3a5508ba32f27f4b8ab2336">xarxa::modificar_stock</a></div><div class="ttdeci">void modificar_stock(int id, int s, int valor)</div><div class="ttdoc">Modificadora del stock de un pais con identificador id. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8cpp_source.html#l00027">xarxa.cpp:27</a></div></div>
<div class="ttc" id="classxarxa_html_a5478c8984b5b3ebfe0aa81be3af0423c"><div class="ttname"><a href="classxarxa.html#a5478c8984b5b3ebfe0aa81be3af0423c">xarxa::ciclo_produccion</a></div><div class="ttdeci">void ciclo_produccion(industria &amp;ind)</div><div class="ttdoc">Modificadora de los stocks de los paises. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8cpp_source.html#l00037">xarxa.cpp:37</a></div></div>
<div class="ttc" id="classxarxa_html_af20c540992ea11953dbf2d614d753659"><div class="ttname"><a href="classxarxa.html#af20c540992ea11953dbf2d614d753659">xarxa::consultar_energias</a></div><div class="ttdeci">void consultar_energias() const </div><div class="ttdoc">Operación de escritura. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8cpp_source.html#l00020">xarxa.cpp:20</a></div></div>
<div class="ttc" id="classxarxa_html_ad037e286c73b9c0e5f62fdd146a0d2c1"><div class="ttname"><a href="classxarxa.html#ad037e286c73b9c0e5f62fdd146a0d2c1">xarxa::~xarxa</a></div><div class="ttdeci">~xarxa()</div><div class="ttdoc">Destructora por defecto. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8cpp_source.html#l00013">xarxa.cpp:13</a></div></div>
<div class="ttc" id="classxarxa_html_aecffcee8c1b62ef2fdb68534c7c11d40"><div class="ttname"><a href="classxarxa.html#aecffcee8c1b62ef2fdb68534c7c11d40">xarxa::consumidores</a></div><div class="ttdeci">int consumidores</div><div class="ttdoc">Número de paises consumidores. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8hpp_source.html#l00034">xarxa.hpp:34</a></div></div>
<div class="ttc" id="classxarxa_html_aef0e84d787621f0879a9423232d0b434"><div class="ttname"><a href="classxarxa.html#aef0e84d787621f0879a9423232d0b434">xarxa::leer_red</a></div><div class="ttdeci">void leer_red(int N)</div><div class="ttdoc">Operación de lectura. </div><div class="ttdef"><b>Definition:</b> <a href="xarxa_8cpp_source.html#l00169">xarxa.cpp:169</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generado por &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
